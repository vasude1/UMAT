\documentclass[11pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{hyperref}

\input{conco}
\usepackage[backend=biber,
style=apa,
style=numeric,
doi=false,isbn=false,url=false,arxiv=false
%sorting=apalike, citestyle=authoryear,
]{biblatex}
\addbibresource{PhD.bib}
\newcommand{\parder}[2]{{\dfrac{\partial #1}{\partial #2}}}
\author{Vasudevan }
\begin{document}
\href{https://github.com/vasude1/UMAT.git}{https://github.com/vasude1/UMAT.git}
\section{Finite Viscoelasticity}
In order to describe the processes that are far from equilibrium, a visceoasltic model has been proposed in \cite{Bergstrom1998, Reese1998} in a thermodynamically consistent way. In this model, the strain energy density is taken to be a function of the deformation as well as some internal variables that characterize the rate dependence of the material. Hence, the strain energy density can be written as 
\begin{equation}
\psi = \hat{\psi}(\bfC,\bfQ_1,\bfQ_2,...,\bfQ_n),
\end{equation}
where $\bfC$ is the right Cauchy Green deformation tensor and $\bfQ_i$ are the internal variables. The evolution of internal variables are described by $n$ equations of the form
\begin{equation}
\dot{\bfQ}_k = \hat{\bff}_k(\bfC,\bfQ_1,\bfQ_2,...,\bfQ_n).
\end{equation}
The evolution equations and the expression for the internal energy shall satisfy the internal dissipation inequality 
\begin{equation}
\frac{1}{2}\bfS:\dot{\bfC} - \dot{\psi} \geq 0.
\end{equation}
Using a Maxwell type representation of the material, the Strain energy function can be split into equilibrium and non-equilibrium parts as
\begin{equation}
\psi = \hat{\psi}_{EQ} (\bar{\bfC}) + \hat{\psi}_{NEQ}(\bfC_e)
\end{equation}
where $\bfC_e$ is the elastic part of the deviatoric Cauchy Green tensor, $\bar{\bfC}$. It has been assumed that $\bar{\bfF} = J^{-\frac{1}{3}} \bfF$ admits a decomposition into an elastic and an inelastic part, $\bar{\bfF} = \bfF_e \bfF_i$.
Using the above expressions in the internal dissipation inequality gives the expressions for stress as 
\begin{equation}
\bfS = -pJ\bfC^{-1} + J^{-2/3}DEV\left[\bfS_{EQ} + \bfS_{NEQ} \right].
\end{equation}
$\bfS_{EQ}$ and $\bfS_{NEQ}$ denote the elastic and viscous contributions to the total stress. $DEV$ represents the deviatoric projection and the first term is a consequence of the incompressibility constraint. These stresses are given by  
\begin{gather}
\bfS_{EQ} = 2\parder{\psi_{EQ}}{\bfC} \\
\bfS_{NEQ} = 2 \bfF_i^{-1} \parder{\psi_{NEQ}}{\bfC_e}\bfF_i^{-T}
\end{gather}
and the deviatoric projector by
\begin{equation}
DEV\left[ \bullet\right] = \bullet - \frac{\bullet:\bfC}{3} \bfC^{-1}.
\end{equation}
The Kirchhoff stress is then given as
\begin{equation}
	\boldsymbol{\tau} = \bfF \bfS \bfF^T = -pJ\bfI + {\bftau}^{iso} = -pJ\bfI + \mathbb{P}:\bar{\bftau},
\end{equation}
where $\bar{\bftau} = \bar{\bftau}_{EQ} + \bar{\bftau}_{NEQ}$ are defines as 
\begin{gather}
	\bar{\bftau}_{EQ} = \parder{\psi_{EQ}(\bar{\bfb})}{\bar{\bfb}}, \\
	\bar{\bftau}_{NEQ} = \parder{\psi_{NEQ}(\bar{\bfb}_e)}{\bar{\bfb}_e}.
\end{gather}
$\mathbb{P}$ is the deviatoric projector in the deformed configuration defined as 
\begin{equation}
\mathbb{P} = \mathbb{I} - \frac{\bfI \otimes \bfI}{3}.
\end{equation}
The dissipation inequality becomes 
\begin{equation}
-\boldsymbol{\tau}_{NEQ}^{iso}:\frac{1}{2} \mathcal{L}_v\bfb_e. \bfb_e^{-1} \geq 0
\label{fv:dissipationineq}
\end{equation}
where $\mathcal{L}_v\bfb_e$ denotes the Lie derivative of $\bfb_e$ defined as 
\begin{equation}
\mathcal{L}_v\bfb_e = \bfFbar \dot{\overline{ \bfC_i^{-1}}} \bfFbar^T
\end{equation}
The expression \ref{fv:dissipationineq} can be satisfied by specifying the evolution equation as
\begin{equation}
-\frac{1}{2} \mathcal{L}_v\bfb_e. \bfb_e^{-1}  = \mathcal{V}^{-1} : \boldsymbol{\tau}_{NEQ}^{iso}
\label{fv:evolution}
\end{equation}
where $\mathcal{V}$ is a fourth order isotropic tensor possibly a function of $\bfb_e$. A slightly different equation has been proposed by \cite{Bergstrom1998}.

\subsection{Integration of the evolution equation}
The integration of equation \ref{fv:dissipationineq} is carried out by a predictor-corrector type algorithm. In the elastic predictor step, the inelastic strains are taken to be fixed and so,
\begin{equation}
	(\bfC_i^{-1})_{tr} = 	(\bfC_i^{-1})_{t_n} \implies \bfb_e^{tr} = \bfFbar (\bfC_i^{-1})_{t_n} \bfFbar^T.
\end{equation}
In the inelastic corrector step, the total deformation is assumed to be held fixed and so, $\mathcal{L}_v\bfb_e = \dot{\bfb}_e$. Using this in equation \ref{fv:evolution} gives
\begin{equation}
	\dot{\bfb}_e {\bfb}^{-1}_e = -2 \left[\mathcal{V}^{-1} : \boldsymbol{\tau}_{NEQ}^{iso} \right]
\end{equation}
The above equation can be integrated using the exponential mapping technique. The resulting expression is 
\begin{equation}
	{\bfb}_e  = \exp  \left[ -2 \int_{t_{n-1}}^{t_n} \mathcal{V}^{-1} : \boldsymbol{\tau}_{NEQ}^{iso} \diff t \right] \bfb_e^{tr}
\end{equation}
\begin{equation}
	({\bfb}_e)_{t_n}  \approx \exp  \left[ -2 \Delta t (\mathcal{V}^{-1} : \boldsymbol{\tau}_{NEQ}^{iso})_{t=t_n} \right] \bfb_e^{tr}
	\label{fv:exponentialmapping}
\end{equation}
The above equation is first order accurate.

Since the material is assumed to be isotropic, ${\bfb}_e$, $\bfb_e^{tr}$ and hence $\bftau_{NEQ}^{iso}$ share the Eigen space. Since $\mathcal{V}^{-1}$ is Isotropic, equation \ref{fv:exponentialmapping} can be written in Eigen basis as
\begin{equation}
	\lambda_{Ae}^2 = \exp \left[- \frac{\Delta t }{\eta_D} \text{dev}(\tau_A) \right]  	(\lambda_{Ae}^2)_{tr}.
\end{equation}
Taking logarithm of both sides,
\begin{equation}
	\epsilon_{Ae} = - \frac{\Delta t }{2 \eta_D} \text{dev}(\tau_A) + 	(\epsilon_{Ae})_{tr}.
\end{equation}
The above equation is non-linear if $\tau_A$ is a non-linear function of $\epsilon_{e}$. Hence, Newton iterations are used to solve it as below.

Defining 
\begin{equation}
	r_A	 = \epsilon_{Ae} + \frac{\Delta t }{2 \eta_D} \text{dev}(\tau_A) - 	(\epsilon_{Ae})_{tr} = 0,
\end{equation}
it can be solved by linearizing around $\epsilon_{Ae} = (\epsilon_{Ae})_k$ as
\begin{equation}
r_A + \parder{r_A}{\epsilon_{Be}} \Delta \epsilon_{Be}	 = 0 \implies K_{AB} \Delta \epsilon_{Be}	 = -r_A
\end{equation}
where $K_{AB} = \parder{r_A}{\epsilon_{Be}}$. The above equation is solved to obtain $\Delta \epsilon_{e}$, which is then used to update the elastic strain as $\epsilon_{k+1} = \epsilon_{k} + \Delta \epsilon_{e}$.

\subsection{Computation of tangent}
The tangent can be computed as 
\begin{equation}
	\mathfrak{C} = 2 \parder{\bfS}{\bfC}.
\end{equation}
This has contributions from the pressure term as well as the deviatoric term. The latter will be dealt with here and the former will be dealt with later on. As a recollection, the deviatoric part is computed as $J^{-2/3} \left(\bfS^{iso}-\frac{\bfS^{iso}:\bfC}{3}\bfC^{-1} \right)$. The derivative of first term is computed as 
\begin{equation}
DEV[\bfS_{IJ}] \parder{J^{-2/3}}{\bfC_{KL}}= -\frac{1}{3} J^{-2/3} DEV[\bfS_{IJ}] {\bfC^{-1}_{KL}}.
\end{equation}
In tensor notation, $DEV[S] \otimes \parder{J^{-2/3}}{\bfC} = -\frac{1}{3} J^{-2/3} DEV[\bfS]  \otimes {\bfC^{-1}}$. The next term is $\parder{\bfS^{iso}}{\bfC}$. Since $\bfS^{iso}$ is a function of $\bar{\bfC}$, the total derivative is computed using the chain rule.
\begin{equation}
 \parder{\bfS^{iso}_{IJ}}{\bfC_{KL}} =  \parder{\bfS^{iso}_{IJ}}{\bar{\bfC}_{MN}} \parder{\bar{\bfC}_{MN}}{{\bfC}_{KL}}
\end{equation}
The second derivative, written using indicial notation is $J^{-2/3}\left[\mathfrak{I}_{MNKL}- \frac{1}{3} \bfC_{MN} \bfC^{-1}_{KL}   \right]$, where $\mathfrak{I}$ is the fourth order identity tensor. using these in the above equation,
\begin{equation}
\parder{\bfS^{iso}_{IJ}}{\bfC_{KL}} =  J^{-2/3}\left[\bar{\mathfrak{C}}_{IJKL}- \frac{1}{3} \bar{\mathfrak{C}}_{IJMN} \bfC_{MN} \bfC^{-1}_{KL} \right]  
\end{equation}
where $\bar{\mathfrak{C}} = \parder{\bfS^{iso}}{\bfCbar}$. In tensor notation, $\parder{\bfS^{iso}}{\bfC} = J^{-2/3}\left[\bar{\mathfrak{C}}- \frac{\bar{\mathfrak{C}}: \bfC}{3}  \otimes \bfC^{-1} \right]$. The next term is $\frac{\bfS^{iso}:\bfC}{3}\bfC^{-1}$. Its derivative is computed using the chain rule as
\begin{equation}
	\parder{\left( \frac{\bfS^{iso}:\bfC}{3}\bfC^{-1} \right)}{\bfC} = \frac{\bfS^{iso}:\bfC}{3} \parder{\bfCinv}{\bfC} + \bfCinv \otimes \parder{\frac{\bfS^{iso}:\bfC}{3}}{\bfC}.
\end{equation} 
The derivative $\parder{\bfCinv}{\bfC} = -\mathcal{I}$, where $\mathcal{I}_{IJKL} = \frac{1}{2} \left[ \bfCinv_{IK} \bfCinv_{JL} + \bfCinv_{IL} \bfCinv_{JK} \right] $. The secon term is again evaluated using chain rule.
\begin{gather}
 	\parder{\frac{\bfS^{iso}_{IJ}\bfC_{JI}}{3}}{\bfC_{KL}} = \frac{1}{3} \left[  \parder{\bfS^{iso}_{IJ}}{\bfC_{KL}} \bfC_{JI} +  \bfS^{iso}_{IJ}  \parder{\bfC_{JI}}{\bfC_{KL}}   \right] 
\end{gather}
The first term has already been evaluated earlier. The second term can be seen to be $\bfS^{iso}_{IJ}  \parder{\bfC_{JI}}{\bfC_{KL}} = \bfS^{iso}_{KL}$. In tensor notation,
\begin{equation}
\parder{\left( \frac{\bfS^{iso}:\bfC}{3}\bfC^{-1} \right)}{\bfC} = -\frac{\bfS^{iso}:\bfC}{3} \mathcal{I}  + \frac{1}{3} \bfCinv \otimes \left\lbrace   \bfC:J^{-2/3} \left[\bar{\mathfrak{C}} - \frac{\bar{\mathfrak{C}}:\bfC}{3}\otimes\bfCinv  \right]  + \bfS^{iso}       \right\rbrace.
\end{equation}
Combining all the above,
\begin{multline}
\frac{1}{2}\mathfrak{C} = -\frac{1}{3} J^{-2/3} DEV[\bfS]  \otimes {\bfC^{-1}} + J^{-2/3}\left[\bar{\mathfrak{C}}- \frac{\bar{\mathfrak{C}}: \bfC}{3}  \otimes \bfC^{-1} \right] +\frac{\bfS^{iso}:\bfC}{3} \mathcal{I}  - \\
\frac{1}{3} \bfCinv \otimes \left\lbrace   \bfC:J^{-2/3} \left[\bar{\mathfrak{C}} - \frac{\bar{\mathfrak{C}}:\bfC}{3}\otimes\bfCinv  \right]  + \bfS^{iso}       \right\rbrace
\end{multline}
Using $\bfS^{iso} = DEV[\bfS] + \frac{\bfS^{iso}:\bfC}{3} \bfCinv$, the above equation can be refined as 
\begin{multline}
\frac{1}{2}\mathfrak{C} = \frac{1}{2}\mathfrak{C}^0-\frac{1}{3} J^{-2/3} DEV[\bfS]  \otimes \bfCinv - -\frac{1}{3}J^{-2/3} \bfCinv \otimes  DEV[\bfS]  + \\
\frac{\bfS^{iso}:\bfC}{3}\left[ \mathcal{I} - \frac{1}{3} \bfCinv \otimes \bfCinv \right]
\end{multline}
where
\begin{equation}
\frac{1}{2}\mathfrak{C}^0=   J^{-2/3}\left[\bar{\mathfrak{C}} - \frac{\bar{\mathfrak{C}}: \bfC}{3}  \otimes \bfC^{-1} - \bfCinv \otimes \frac{\bar{\mathfrak{C}}: \bfC}{3} + \frac{\bfC:\bar{\mathfrak{C}} :\bfC}{9}  \bfCinv \otimes \bfCinv \right] 
\end{equation}
The push forward of the tangent to spatial configuration is
\begin{equation}
 \mathfrak{c} = \phi_* \left[\mathfrak{C} \right] =  \mathbb{P}:\bar{\mathfrak{c}}:\mathbb{P} - \frac{1}{3} J^{-2/3} \left[{\bftau}^{iso} \otimes \bfI  +\bfI \otimes  {\bftau}^{iso} \right] + \text{tr}(\bftaubar) \mathbb{P}.
\end{equation}

\subsection{Plane stress version of FV Model}
The expression for Kirchhoff Stress is given by
\begin{equation}
\bftau = Jp\bfI + \mathbb{P}:\bar{\bftau},
\end{equation}
where
\begin{equation}
\bar{\bftau} = \bar{\bftau} + \bar{\bftau}^v
\end{equation}
Under Plane stress conditions, for perfectly incompressible material, the expression for pressure can be established by using the condition that $\tau_{33}=0$. This results in
\begin{equation}
Jp = -2\left(\bar{\tau}_{33}-\frac{1}{3}\Tr(\bar{\bftau}) \right)-2\left(\bar{\tau}^v_{33}-\frac{1}{3}\Tr(\bar{\bftau}^v) \right)
\end{equation}
The above expression is used to derive the contribution of the pressure term to the material tangent. The material tangent in the spatial configuration in the Eigen basis can be obtained as \cite{Bonet2008}
\begin{equation}
\mathfrak{C}= \sum_{\alpha,\beta =1}^{3} \frac{1}{J}\parder{\tau_i}{\log \lambda_j} \boldsymbol{\eta}_{\alpha\alpha\beta\beta} - \sum_{\alpha=1}^{3} 2 \sigma_{\alpha\alpha}\boldsymbol{\eta}_{\alpha\alpha\alpha\alpha} + \sum_{\alpha,\beta =1, \alpha\neq\beta}^{3} \frac{\sigma_{\alpha\alpha} \lambda_\beta^2-\sigma_{\beta\beta} \lambda_\alpha^2}{\lambda_\alpha^2- \lambda_\beta^2} \left( \boldsymbol{\eta}_{\alpha\beta\alpha\beta} + \boldsymbol{\eta}_{\alpha\beta\beta\alpha} \right)
\end{equation}

\end{document}
